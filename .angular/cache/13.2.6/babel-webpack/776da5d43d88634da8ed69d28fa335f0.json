{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PostCreateComponent = void 0;\n\nvar forms_1 = require(\"@angular/forms\");\n\nvar router_1 = require(\"@angular/router\");\n\nvar posts_service_1 = require(\"../posts.service\");\n\nvar mime_type_validator_1 = require(\"./mime-type.validator\");\n\nvar i0 = require(\"@angular/core\");\n\nvar i1 = require(\"../posts.service\");\n\nvar i2 = require(\"@angular/router\");\n\nfunction PostCreateComponent_mat_spinner_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\");\n  }\n}\n\nfunction PostCreateComponent_form_2_mat_error_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Please enter a post title.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PostCreateComponent_form_2_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelement(1, \"img\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r4.imagePreview, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r4.form.value.title);\n  }\n}\n\nfunction PostCreateComponent_form_2_mat_error_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Please enter a post title.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PostCreateComponent_form_2_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 2);\n    i0.ɵɵlistener(\"submit\", function PostCreateComponent_form_2_Template_form_submit_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      var ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.onSavePost();\n    });\n    i0.ɵɵelementStart(1, \"mat-form-field\");\n    i0.ɵɵelement(2, \"input\", 3);\n    i0.ɵɵtemplate(3, PostCreateComponent_form_2_mat_error_3_Template, 2, 0, \"mat-error\", 0);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\")(5, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function PostCreateComponent_form_2_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r7);\n\n      var _r3 = i0.ɵɵreference(8);\n\n      return _r3.click();\n    });\n    i0.ɵɵtext(6, \"Pick Image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"input\", 5, 6);\n    i0.ɵɵlistener(\"change\", function PostCreateComponent_form_2_Template_input_change_7_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      var ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.onImagePicked($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(9, PostCreateComponent_form_2_div_9_Template, 2, 2, \"div\", 7);\n    i0.ɵɵelementStart(10, \"mat-form-field\");\n    i0.ɵɵelement(11, \"textarea\", 8);\n    i0.ɵɵtemplate(12, PostCreateComponent_form_2_mat_error_12_Template, 2, 0, \"mat-error\", 0);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 9);\n    i0.ɵɵtext(14, \"Save Post\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"title\").invalid);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.imagePreview !== \"\" && ctx_r1.imagePreview && ctx_r1.form.get(\"image\").valid);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"content\").invalid);\n  }\n}\n\nvar PostCreateComponent =\n/** @class */\nfunction () {\n  function PostCreateComponent(postsService, route) {\n    this.postsService = postsService;\n    this.route = route;\n    this.enteredTitle = \"\";\n    this.enteredContent = \"\";\n    this.isLoading = false;\n    this.mode = \"create\";\n  }\n\n  PostCreateComponent.prototype.ngOnInit = function () {\n    var _this = this;\n\n    this.form = new forms_1.FormGroup({\n      title: new forms_1.FormControl(null, {\n        validators: [forms_1.Validators.required, forms_1.Validators.minLength(3)]\n      }),\n      content: new forms_1.FormControl(null, {\n        validators: [forms_1.Validators.required]\n      }),\n      image: new forms_1.FormControl(null, {\n        validators: [forms_1.Validators.required],\n        asyncValidators: [mime_type_validator_1.mimeType]\n      })\n    });\n    this.route.paramMap.subscribe(function (paramMap) {\n      if (paramMap.has(\"postId\")) {\n        _this.mode = \"edit\";\n        _this.postId = paramMap.get(\"postId\");\n        _this.isLoading = true;\n\n        _this.postsService.getPost(_this.postId).subscribe(function (postData) {\n          _this.isLoading = false;\n          _this.post = {\n            id: postData._id,\n            title: postData.title,\n            content: postData.content,\n            imagePath: postData.imagePath\n          };\n\n          _this.form.setValue({\n            title: _this.post.title,\n            content: _this.post.content,\n            image: _this.post.imagePath\n          });\n        });\n      } else {\n        _this.mode = \"create\";\n        _this.postId = null;\n      }\n    });\n  };\n\n  PostCreateComponent.prototype.onImagePicked = function (event) {\n    var _this = this;\n\n    var file = event.target.files[0];\n    this.form.patchValue({\n      image: file\n    });\n    this.form.get(\"image\").updateValueAndValidity();\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      _this.imagePreview = reader.result;\n    };\n\n    reader.readAsDataURL(file);\n  };\n\n  PostCreateComponent.prototype.onSavePost = function () {\n    if (this.form.invalid) {\n      return;\n    }\n\n    this.isLoading = true;\n\n    if (this.mode === \"create\") {\n      this.postsService.addPost(this.form.value.title, this.form.value.content, this.form.value.image);\n    } else {\n      this.postsService.updatePost(this.postId, this.form.value.title, this.form.value.content, this.form.value.image);\n    }\n\n    this.form.reset();\n  };\n\n  PostCreateComponent.ɵfac = function PostCreateComponent_Factory(t) {\n    return new (t || PostCreateComponent)(i0.ɵɵdirectiveInject(i1.PostsService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n  };\n\n  PostCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PostCreateComponent,\n    selectors: [[\"app-post-create\"]],\n    decls: 3,\n    vars: 2,\n    consts: [[4, \"ngIf\"], [3, \"formGroup\", \"submit\", 4, \"ngIf\"], [3, \"formGroup\", \"submit\"], [\"matInput\", \"\", \"type\", \"text\", \"formControlName\", \"title\", \"placeholder\", \"Post Title\"], [\"mat-stroked-button\", \"\", \"type\", \"button\", 3, \"click\"], [\"type\", \"file\", 3, \"change\"], [\"filePicker\", \"\"], [\"class\", \"image-preview\", 4, \"ngIf\"], [\"matInput\", \"\", \"rows\", \"4\", \"formControlName\", \"content\", \"placeholder\", \"Post Content\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", \"type\", \"submit\"], [1, \"image-preview\"], [3, \"src\", \"alt\"]],\n    template: function PostCreateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"mat-card\");\n        i0.ɵɵtemplate(1, PostCreateComponent_mat_spinner_1_Template, 1, 0, \"mat-spinner\", 0);\n        i0.ɵɵtemplate(2, PostCreateComponent_form_2_Template, 15, 4, \"form\", 1);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\n      }\n    },\n    styles: [\"mat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\nmat-spinner[_ngcontent-%COMP%] {\\n  margin: auto;\\n}\\n\\ninput[type=\\\"file\\\"][_ngcontent-%COMP%] {\\n  visibility: hidden;\\n}\\n\\n.image-preview[_ngcontent-%COMP%] {\\n  height: 5rem;\\n  margin: 1rem 0;\\n}\\n\\n.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QtY3JlYXRlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0VBRUUsV0FBVztBQUNiOztBQUVBO0VBQ0UsWUFBWTtBQUNkOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxZQUFZO0FBQ2QiLCJmaWxlIjoicG9zdC1jcmVhdGUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIm1hdC1mb3JtLWZpZWxkLFxudGV4dGFyZWEge1xuICB3aWR0aDogMTAwJTtcbn1cblxubWF0LXNwaW5uZXIge1xuICBtYXJnaW46IGF1dG87XG59XG5cbmlucHV0W3R5cGU9XCJmaWxlXCJdIHtcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xufVxuXG4uaW1hZ2UtcHJldmlldyB7XG4gIGhlaWdodDogNXJlbTtcbiAgbWFyZ2luOiAxcmVtIDA7XG59XG5cbi5pbWFnZS1wcmV2aWV3IGltZyB7XG4gIGhlaWdodDogMTAwJTtcbn1cbiJdfQ== */\"]\n  });\n  return PostCreateComponent;\n}();\n\nexports.PostCreateComponent = PostCreateComponent;","map":{"version":3,"sources":["C:/Users/roman/Desktop/Mean/Posts-App/src/app/posts/post-create/post-create.component.ts"],"names":["Object","defineProperty","exports","value","PostCreateComponent","forms_1","require","router_1","posts_service_1","mime_type_validator_1","i0","i1","i2","PostCreateComponent_mat_spinner_1_Template","rf","ctx","ɵɵelement","PostCreateComponent_form_2_mat_error_3_Template","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","PostCreateComponent_form_2_div_9_Template","ctx_r4","ɵɵnextContext","ɵɵadvance","ɵɵproperty","imagePreview","ɵɵsanitizeUrl","form","title","PostCreateComponent_form_2_mat_error_12_Template","PostCreateComponent_form_2_Template","_r7","ɵɵgetCurrentView","ɵɵlistener","PostCreateComponent_form_2_Template_form_submit_0_listener","ɵɵrestoreView","ctx_r6","onSavePost","ɵɵtemplate","PostCreateComponent_form_2_Template_button_click_5_listener","_r3","ɵɵreference","click","PostCreateComponent_form_2_Template_input_change_7_listener","$event","ctx_r9","onImagePicked","ctx_r1","get","invalid","valid","postsService","route","enteredTitle","enteredContent","isLoading","mode","prototype","ngOnInit","_this","FormGroup","FormControl","validators","Validators","required","minLength","content","image","asyncValidators","mimeType","paramMap","subscribe","has","postId","getPost","postData","post","id","_id","imagePath","setValue","event","file","target","files","patchValue","updateValueAndValidity","reader","FileReader","onload","result","readAsDataURL","addPost","updatePost","reset","ɵfac","PostCreateComponent_Factory","t","ɵɵdirectiveInject","PostsService","ActivatedRoute","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","PostCreateComponent_Template","styles"],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.PostCreateComponent = void 0;\r\nvar forms_1 = require(\"@angular/forms\");\r\nvar router_1 = require(\"@angular/router\");\r\nvar posts_service_1 = require(\"../posts.service\");\r\nvar mime_type_validator_1 = require(\"./mime-type.validator\");\r\nvar i0 = require(\"@angular/core\");\r\nvar i1 = require(\"../posts.service\");\r\nvar i2 = require(\"@angular/router\");\r\nfunction PostCreateComponent_mat_spinner_1_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"mat-spinner\");\r\n} }\r\nfunction PostCreateComponent_form_2_mat_error_3_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-error\");\r\n    i0.ɵɵtext(1, \"Please enter a post title.\");\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction PostCreateComponent_form_2_div_9_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 10);\r\n    i0.ɵɵelement(1, \"img\", 11);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    var ctx_r4 = i0.ɵɵnextContext(2);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"src\", ctx_r4.imagePreview, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r4.form.value.title);\r\n} }\r\nfunction PostCreateComponent_form_2_mat_error_12_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-error\");\r\n    i0.ɵɵtext(1, \"Please enter a post title.\");\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction PostCreateComponent_form_2_Template(rf, ctx) { if (rf & 1) {\r\n    var _r7 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"form\", 2);\r\n    i0.ɵɵlistener(\"submit\", function PostCreateComponent_form_2_Template_form_submit_0_listener() { i0.ɵɵrestoreView(_r7); var ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.onSavePost(); });\r\n    i0.ɵɵelementStart(1, \"mat-form-field\");\r\n    i0.ɵɵelement(2, \"input\", 3);\r\n    i0.ɵɵtemplate(3, PostCreateComponent_form_2_mat_error_3_Template, 2, 0, \"mat-error\", 0);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(4, \"div\")(5, \"button\", 4);\r\n    i0.ɵɵlistener(\"click\", function PostCreateComponent_form_2_Template_button_click_5_listener() { i0.ɵɵrestoreView(_r7); var _r3 = i0.ɵɵreference(8); return _r3.click(); });\r\n    i0.ɵɵtext(6, \"Pick Image\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(7, \"input\", 5, 6);\r\n    i0.ɵɵlistener(\"change\", function PostCreateComponent_form_2_Template_input_change_7_listener($event) { i0.ɵɵrestoreView(_r7); var ctx_r9 = i0.ɵɵnextContext(); return ctx_r9.onImagePicked($event); });\r\n    i0.ɵɵelementEnd()();\r\n    i0.ɵɵtemplate(9, PostCreateComponent_form_2_div_9_Template, 2, 2, \"div\", 7);\r\n    i0.ɵɵelementStart(10, \"mat-form-field\");\r\n    i0.ɵɵelement(11, \"textarea\", 8);\r\n    i0.ɵɵtemplate(12, PostCreateComponent_form_2_mat_error_12_Template, 2, 0, \"mat-error\", 0);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(13, \"button\", 9);\r\n    i0.ɵɵtext(14, \"Save Post\");\r\n    i0.ɵɵelementEnd()();\r\n} if (rf & 2) {\r\n    var ctx_r1 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.form);\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"title\").invalid);\r\n    i0.ɵɵadvance(6);\r\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.imagePreview !== \"\" && ctx_r1.imagePreview && ctx_r1.form.get(\"image\").valid);\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.form.get(\"content\").invalid);\r\n} }\r\nvar PostCreateComponent = /** @class */ (function () {\r\n    function PostCreateComponent(postsService, route) {\r\n        this.postsService = postsService;\r\n        this.route = route;\r\n        this.enteredTitle = \"\";\r\n        this.enteredContent = \"\";\r\n        this.isLoading = false;\r\n        this.mode = \"create\";\r\n    }\r\n    PostCreateComponent.prototype.ngOnInit = function () {\r\n        var _this = this;\r\n        this.form = new forms_1.FormGroup({\r\n            title: new forms_1.FormControl(null, {\r\n                validators: [forms_1.Validators.required, forms_1.Validators.minLength(3)]\r\n            }),\r\n            content: new forms_1.FormControl(null, { validators: [forms_1.Validators.required] }),\r\n            image: new forms_1.FormControl(null, {\r\n                validators: [forms_1.Validators.required],\r\n                asyncValidators: [mime_type_validator_1.mimeType]\r\n            })\r\n        });\r\n        this.route.paramMap.subscribe(function (paramMap) {\r\n            if (paramMap.has(\"postId\")) {\r\n                _this.mode = \"edit\";\r\n                _this.postId = paramMap.get(\"postId\");\r\n                _this.isLoading = true;\r\n                _this.postsService.getPost(_this.postId).subscribe(function (postData) {\r\n                    _this.isLoading = false;\r\n                    _this.post = {\r\n                        id: postData._id,\r\n                        title: postData.title,\r\n                        content: postData.content,\r\n                        imagePath: postData.imagePath\r\n                    };\r\n                    _this.form.setValue({\r\n                        title: _this.post.title,\r\n                        content: _this.post.content,\r\n                        image: _this.post.imagePath\r\n                    });\r\n                });\r\n            }\r\n            else {\r\n                _this.mode = \"create\";\r\n                _this.postId = null;\r\n            }\r\n        });\r\n    };\r\n    PostCreateComponent.prototype.onImagePicked = function (event) {\r\n        var _this = this;\r\n        var file = event.target.files[0];\r\n        this.form.patchValue({ image: file });\r\n        this.form.get(\"image\").updateValueAndValidity();\r\n        var reader = new FileReader();\r\n        reader.onload = function () {\r\n            _this.imagePreview = reader.result;\r\n        };\r\n        reader.readAsDataURL(file);\r\n    };\r\n    PostCreateComponent.prototype.onSavePost = function () {\r\n        if (this.form.invalid) {\r\n            return;\r\n        }\r\n        this.isLoading = true;\r\n        if (this.mode === \"create\") {\r\n            this.postsService.addPost(this.form.value.title, this.form.value.content, this.form.value.image);\r\n        }\r\n        else {\r\n            this.postsService.updatePost(this.postId, this.form.value.title, this.form.value.content, this.form.value.image);\r\n        }\r\n        this.form.reset();\r\n    };\r\n    PostCreateComponent.ɵfac = function PostCreateComponent_Factory(t) { return new (t || PostCreateComponent)(i0.ɵɵdirectiveInject(i1.PostsService), i0.ɵɵdirectiveInject(i2.ActivatedRoute)); };\r\n    PostCreateComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PostCreateComponent, selectors: [[\"app-post-create\"]], decls: 3, vars: 2, consts: [[4, \"ngIf\"], [3, \"formGroup\", \"submit\", 4, \"ngIf\"], [3, \"formGroup\", \"submit\"], [\"matInput\", \"\", \"type\", \"text\", \"formControlName\", \"title\", \"placeholder\", \"Post Title\"], [\"mat-stroked-button\", \"\", \"type\", \"button\", 3, \"click\"], [\"type\", \"file\", 3, \"change\"], [\"filePicker\", \"\"], [\"class\", \"image-preview\", 4, \"ngIf\"], [\"matInput\", \"\", \"rows\", \"4\", \"formControlName\", \"content\", \"placeholder\", \"Post Content\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", \"type\", \"submit\"], [1, \"image-preview\"], [3, \"src\", \"alt\"]], template: function PostCreateComponent_Template(rf, ctx) { if (rf & 1) {\r\n            i0.ɵɵelementStart(0, \"mat-card\");\r\n            i0.ɵɵtemplate(1, PostCreateComponent_mat_spinner_1_Template, 1, 0, \"mat-spinner\", 0);\r\n            i0.ɵɵtemplate(2, PostCreateComponent_form_2_Template, 15, 4, \"form\", 1);\r\n            i0.ɵɵelementEnd();\r\n        } if (rf & 2) {\r\n            i0.ɵɵadvance(1);\r\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\r\n            i0.ɵɵadvance(1);\r\n            i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\r\n        } }, styles: [\"mat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\nmat-spinner[_ngcontent-%COMP%] {\\n  margin: auto;\\n}\\n\\ninput[type=\\\"file\\\"][_ngcontent-%COMP%] {\\n  visibility: hidden;\\n}\\n\\n.image-preview[_ngcontent-%COMP%] {\\n  height: 5rem;\\n  margin: 1rem 0;\\n}\\n\\n.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvc3QtY3JlYXRlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0VBRUUsV0FBVztBQUNiOztBQUVBO0VBQ0UsWUFBWTtBQUNkOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxZQUFZO0FBQ2QiLCJmaWxlIjoicG9zdC1jcmVhdGUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIm1hdC1mb3JtLWZpZWxkLFxudGV4dGFyZWEge1xuICB3aWR0aDogMTAwJTtcbn1cblxubWF0LXNwaW5uZXIge1xuICBtYXJnaW46IGF1dG87XG59XG5cbmlucHV0W3R5cGU9XCJmaWxlXCJdIHtcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xufVxuXG4uaW1hZ2UtcHJldmlldyB7XG4gIGhlaWdodDogNXJlbTtcbiAgbWFyZ2luOiAxcmVtIDA7XG59XG5cbi5pbWFnZS1wcmV2aWV3IGltZyB7XG4gIGhlaWdodDogMTAwJTtcbn1cbiJdfQ== */\"] });\r\n    return PostCreateComponent;\r\n}());\r\nexports.PostCreateComponent = PostCreateComponent;\r\n"]},"metadata":{},"sourceType":"script"}